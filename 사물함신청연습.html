<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 위 3개의 메타 태그는 *반드시* head 태그의 처음에 와야합니다; 어떤 다른 콘텐츠들은 반드시 이 태그들 *다음에* 와야 합니다 -->
    <title>사물함 연습</title>

    <!-- 합쳐지고 최소화된 최신 CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">

    <!-- IE8 에서 HTML5 요소와 미디어 쿼리를 위한 HTML5 shim 와 Respond.js -->
    <!-- WARNING: Respond.js 는 당신이 file:// 을 통해 페이지를 볼 때는 동작하지 않습니다. -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <style>
      div{
        border:1px solid red;
      }

      .frame{
        border:1px solid red;
        height: 400px;
        margin-bottom: 50px;
      }

      nav{
       height: 100px;
      }

      .notice{
        padding:0px;
        margin-bottom: 10px;
      }
  
/*      hr{
        width:100p%;
        color:grey;
        border:100px;
      }*/

      .cabinet-preview{
        height: 200px;
        margin:10px;
        background-color: #DFDFDF;
      }

      .selection-info{
        height:80px;
        background-color: #888888;
      }
      .selection-window{
        height:320px;
        background-color:#E7E7E7;
      }

      .sel-win{
        width:420px;
        margin:0 auto;
        margin-top:50px;
      }

      .cabinet{
        margin:5px;
        height:50px;
        text-align:center;
      }

      .mycabinet{
         width:35px;
        height:35px;
        margin:3px;
        background-color:#FFFFFF;
        border:1px solid grey;
        outline:0;
        font-size:12px;
      }

      .mycabinet:hover{
        background-color: grey;
      }
      .mycabinet:active{
        background-color: red;
      }

      .modal-header{
        background-color:#070289;
        color:white;
      }

    </style>

  </head>
  <body>
    <nav class="navbar navbar-default navbar-inverse">
      <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Multimedia Engineering</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="#">공지사항</a></li>
            <li class="dropdown active">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">신청 <span class="caret"></span></a>
              <ul class="dropdown-menu dropdown-menu-left" role="menu">
                <li><a href="#">사물함 신청</a></li>
                <li><a href="#">MT 신청</a></li>
              </ul>
            </li>
            <!-- 옮겼습니다 -->
            <li ><a href="#">건의사항<span class="sr-only">(current)</span></a></li>
            <li><a href="#">자유게시판</a></li>
            <li><a href="#">남광쓰<span class="glyphicon glyphicon-user" aria-hidden="true"></span></a></li>
          </ul>
        </div><!-- /.navbar-collapse -->
      </div><!-- /.container-fluid -->
    </nav>

    <div class="container">
      <div class="row notice">
        <div class="col-md-10 col-md-offset-1 col-xs-12">
          2020년 0학기 사물함 신청 / 신청일시 : 2020년 00월 00일 00시 <br>
          <p class="regiDay"style="color:red">*오늘은 신청일 입니다.</p>
        </div>
      </div>
      <div class="row">
        <!-- 작은 모니터 사이즈 이상에서만 두 개로 보입니다. -->
        <!-- 사물함배치도 -->
          <div class="col-md-4 col-md-push-7 frame">
            <div class="row bg-info">
               <div class="text-center" style="height:40px; margin:20px 0px;  font-size:2em;"> 
                사물함 배치도
               </div>
            </div>
            <br>
            <div class="row cabinet-preview">
                <div class="col-xs-12">
                  <div class="row">
                    <br>
                    <br>
                    <br><br>
                  </div>

                  <div class="row" style="margin:0 10px">
                    <div class="" data-toggle="buttons">
                      <label class="btn btn-primary cabinet" onclick="showCabi(0)">
                        <input class="btn" type="radio" name="cabinets" id="option1" autocomplete="off" checked > 1
                      </label>
                      <label> 2</label>
                      <label class="btn btn-primary cabinet" onclick="showCabi(1)">
                        <input type="radio" name="cabinets" id="option3" autocomplete="off"> 3
                      </label>
                      <label class="btn btn-primary cabinet" style="width:55px" onclick="showCabi(2)">
                        <input type="radio" name="cabinets" id="option3" autocomplete="off" onclick="showCabi()"> 4
                      </label>
                      <label class="btn btn-primary cabinet" style="width:50px" onclick="showCabi(3)">
                        <input type="radio" name="cabinets" id="option3" autocomplete="off"> 5
                      </label>                                
                    </div>            
                  </div>
                </div>
            </div>
            <div class="row" style="margin-top:30px; margin-left:10px; margin-right:10px;">
              <div class="col-xs-4">
                <button type = "button" data-toggle="modal" class="btn btn-danger btn-block" href="#" role="button" data-target="#attention">주의사항</button>
              </div>
              <div class="col-xs-8">
                <button type = "button" data-toggle="modal" class="btn btn-primary btn-block" type="submit" data-target="#applyCabinet">사물함 신청하기</button>
              </div>
              </div>

              <!--주의사항 모달-->
              <div class="modal fade" id="attention" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                      <h4 class="modal-title" id="myModalLabel">주의사항</h4>
                    </div>
                    <div class="modal-body">
                      [사물함 신청 안내 및 주의사항]
                      -학생회비 납부자에 한해 무료입니다.<br>
                      휴학생과 학생회비 비납부자에게는  사물함 배정을 하지 않습니다.<br><br>

                      -연장을 원하는 경우, <br>
                      동일 좌석을 선택하시면 됩니다.<br><br>

                      -현재 사물함을 이용중인 사람들은  00까지 자진 철거 부탁합니다.<br>
                      집행부 철거가 00일에 진행 될 예정입니다.

                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                      <button type="button" class="btn btn-primary">Save changes</button>
                    </div>
                  </div>
                </div>
              </div>

              <!--..아 모달이 필요한가 생각해보니까.. 그냥 알러트 하면 되는 거 아님?
                암튼 일단은 신청 모달임.-->
              <div class="modal fade" id="applyCabinet" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                      <h4 class="modal-title" id="myModalLabel">사물함 신청</h4>
                    </div>
                    <div class="modal-body">
                        사물함을 신청하시겠습니까?
                    </div>
                    <!-- 알러트도 뜨면 좋겠구만. 신청이 완료되었습니다. -->
                    <div class="modal-footer">
                      <button type="button" class="btn btn-default" data-dismiss="modal">예</button>
                      <button type="button" class="btn btn-primary" data-dismiss="modal">아니요</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          
          <div class="col-md-5 col-md-pull-3 frame">
            <div class="row">
              <div class="col-xs-12 selection-info">
                <br>
                <div style="width:20px; height:20px; background-color: red; display:inline-block"></div><span style="color:white; font-weight:bold"> 선택</span>
                <div style="width:20px; height:20px; background-color: #070289; display:inline-block"></div><span style="color:white; font-weight:bold"> 선택 불가</span>
                <div style="width:20px; height:20px; background-color: white; display:inline-block"></div><span style="color:white; font-weight:bold"> 선택 가능</span>
                <div style="width:20px; height:20px; background-color: yellow; display:inline-block"></div><span style="color:white; font-weight:bold"> 내 사물함</span>
                <div style="display:inline-block; color:white; font-weight:bold; margin-left:10px"> 남은 좌석 (나중)</div>
              

              </div>
            </div>
            <div class="row selection-window">
              <div class="sel-win" style="border:1px solid blue;">

              </div>
            </div>
          </div><!-- col-md어쩌고 -->

          </div><!--row-->
      </div><!--container-->
    </div>

    <script>
      //생각해보니 지금은 이렇게 만들지만.. 나중에 다른 사람이 선택한 좌석에 대해서는
      //비활성화를 해놔야 되는거잖아..? 그럼 onclick함수를 쓰면 안되는건가?

      var selNum=-1;
      var samePage =0;
      function myclick(num){
        console.log(num + "함수가 불렸어요ㅣ");
        //document.querySelector(".target").innerHTML = num;
        var b = document.getElementsByName(num);

        if(selNum!=-1 && samePage==1){
          var before = document.getElementsByName(selNum);
          before[0].style.backgroundColor='white';
        }

        b[0].style.backgroundColor= 'red';
        console.log("제대로 됐을까요?");
        selNum = num;
        samePage =1;
        //중복 클릭했을 때 바꾸게 해주는 것도 할까요??
      }

      function showCabi(cabinetNum){
        console.log("보여주세요.." + cabinetNum);
        //다른 화면으로 넘어왔음을 표시한다.
        samePage = 0;

        var cabiSizeTable = [255, 255, 420, 340];
        console.log(cabinetNum);
        var cabiSize = cabiSizeTable[cabinetNum] + "px";
        console.log(cabiSize);
        var cabi = document.querySelector(".sel-win");
        cabi.style.width=cabiSize;


        var target = document.querySelector(".sel-win");
        var cabinetCol = [6, 6, 10, 8];
        var cabinetStartNum = [1, 31, 61, 111];
        var num = cabinetStartNum[cabinetNum];
        var htmlVal = "";
        //target.innerHTML = "<br><br>";

        //나중에 disabled 필요한 애들은 db에서 번호 받아와서
        //그 번호 값 있으면 따로 만들면 되겠지??
        //음.. 이따구로 하면 안되나? ^0^ 모르겠다.. 동시성 처리 이상하게 되는거 아니냐...


        console.log(target.innerHTML);
        for(var floor =1; floor<=5;floor++){
          for(var garo = 0; garo<cabinetCol[cabinetNum];garo++){
            htmlVal += "<button class='mycabinet' name='"+num+"' "+"onClick='myclick(" + num + ")'>" + num + "</button>";
            num += 1;
          }
          htmlVal+="<br>"
        }
        htmlVal +="</div>";
        target.innerHTML= htmlVal;
        console.log(target.innerHTML);
      }

      function init(){
        showCabi(0);
        var isDay = document.querySelector(".regiDay");
        var year = new Date().toISOString().slice(0,4);
        var month = new Date().toISOString().slice(5,7);
        var day = new Date().toISOString().slice(8, 10)

        console.log(year);
        console.log(month);
        console.log(day);

        //여기에 사실 함수(날짜가 맞는지 확인하는 함수 등..)
        if(1){
          isDay.innerHTML = "오늘은 신청일 입니다.";
        }
        else
        {
          isDay.innerHTML = "오늘은 신청일이 아닙니다.";
          //사실 버튼도 비활성화 해야하는 걸로 압니다.
          //신청하기 버튼..
        }

        //오늘이 그 날인지 아닌지를. 음.. 
      }

      init();

    </script>
    <!-- jQuery (부트스트랩의 자바스크립트 플러그인을 위해 필요합니다) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <!-- 모든 컴파일된 플러그인을 포함합니다 (아래), 원하지 않는다면 필요한 각각의 파일을 포함하세요 -->
   <!-- 합쳐지고 최소화된 최신 자바스크립트 -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
  </body>
</html>
